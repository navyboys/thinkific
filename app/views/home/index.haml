.login-wrapper
  .login
    .login-welcome
      %h1= 'Welcome to Thinkific API'
      %h4
        %span API Key:
        %span#token= current_user.token
      %h4
        %span Current Integer:
        %span#current-int= @thinkific_integer.content.to_s
      %a#btn-next.btn.btn-success= 'Next'
      %input#new-int{placeholder: 'New Integer'}
      %a#btn-reset.btn.btn-primary= 'Reset'
    .logout
      = link_to 'Logout', logout_path, method: :delete

:javascript

  var $currentInt = $('#current-int');
  var $newInt = $('#new-int');
  var token = $('#token').html();

  $('#btn-next').on('click', function() {
    var int = parseInt($currentInt.html());
    $currentInt.html(int + 1);
    $.get('api/v1/next',  { token: token }).fail(function() {
      $currentInt.html(int);
    });
  });

  $('#btn-reset').on('click', function() {
    var int = parseInt($currentInt.html());
    var newInt = parseInt($newInt.val());
    $currentInt.html(newInt);
    $.ajax({
      method: 'PUT',
      url: 'api/v1/current',
      data: { current: newInt, token: token }
    }).fail(function(msg) {
      $currentInt.html(int);
      alert(msg);
    });
  });
